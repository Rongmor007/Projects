% Проверка приема команд прямого управления

% получение всех шагов главной последовательности
%% set substeps = e.get_substeps(step, 'NumericLimitTest', 'Main')

% Получение статуса шага
%% set status = h.translate_en_to_ru(e.get_step_status(step))

% Заголовок 
\multicolumn{1}{|C{\VAR{w4}}|}{\VAR{current_step_name[0]}} & \multicolumn{4}{C{\VAR{w2_7}}|}{\VAR{current_step_name[1]}} &  \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status}}} \\

% Списки для дальнейшего заполнения таблицы
%% set kits = ['Основной комплект', 'Резервный комплект']
%% set names_of_headers = ['Цепь №', 'Измерено (мА)', 'Допустимое значение (мА)']
%% set names = ['Ток в цепях ОН1, ОН2', 'Напряжение в цепях OH1, OH2 (включено)', 'Напряжение в цепях OH1, OH2 (выключено)']
%% set chains = ['13', '28']
%% set kits = ['Основной комплект', 'Резервный комплект']

%% set prec = 2

% Списки с результатами
%% set results = []
%% set status_substep = []

% Вычисление результатов для цепей комплектных
%% for step in substeps:
%% set dump = results.append(e.get_numeric_limit(step))
%% set temp_status = e.get_step_status(step)
%% set dump = status_substep.append(temp_status)
%% endfor

%% set status_substep = h.status_of_substeps(status_substep, key = 0)


% Шапка 'Ток в цепях ОН1, ОН2'
\hhline{~|--|--|--|-}
& \multirow{3}{23mm}{\VAR{names[0]}} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{names_of_headers[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{names_of_headers[1]}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{names_of_headers[2]}} & \tabularnewline

% Цепь 13
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[0]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[0]['lo']}  ÷ \VAR{results[0]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[0]}}} \tabularnewline

% Цепь 28
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[1]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[1]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[1]['lo']}  ÷ \VAR{results[1]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[1]}}} \tabularnewline

% Шапка  'Напряжение в цепях OH1, OH2 (включено)'
\hhline{~|--|--|--|-}
& \multirow{3}{33mm}{\VAR{names[1]}} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{names_of_headers[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{names_of_headers[1]}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{names_of_headers[2]}} & \tabularnewline

% Цепь 13
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[2]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[2]['lo']}  ÷ \VAR{results[2]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[2]}}} \tabularnewline

% Цепь 28
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[1]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[3]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[3]['lo']}  ÷ \VAR{results[3]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[3]}}} \tabularnewline

% Шапка  'Напряжение в цепях OH1, OH2 (выключено)'
\hhline{~|--|--|--|-}
& \multirow{8}{33mm}{\VAR{names[2]}} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{names_of_headers[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{names_of_headers[1]}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{names_of_headers[2]}} & \tabularnewline

% Основной комплект
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{3}{C{\VAR{w3_7}}|}{\VAR{kits[0]}} & \tabularnewline

% Цепь 13
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[4]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[4]['lo']}  ÷ \VAR{results[4]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[4]}}} \tabularnewline

% Цепь 28
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[1]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[5]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[5]['lo']}  ÷ \VAR{results[5]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[5]}}} \tabularnewline

% Резервный комплект
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{3}{C{\VAR{w3_7}}|}{\VAR{kits[1]}} & \tabularnewline

% Цепь 13
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[6]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[6]['lo']}  ÷ \VAR{results[6]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[6]}}} \tabularnewline

% Цепь 28
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[1]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[7]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[7]['lo']}  ÷ \VAR{results[7]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[7]}}} \tabularnewline