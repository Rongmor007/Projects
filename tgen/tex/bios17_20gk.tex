% Проверка приема команд прямого управления на переключение комплектов электроники БИОС

% получение всех шагов главной последовательности
%% set substeps = e.get_substeps(step, 'NumericLimitTest', 'Main')

% Получение статуса шага
%% set status = h.translate_en_to_ru(e.get_step_status(step))

% Заголовок 
\multicolumn{1}{|C{\VAR{w4}}|}{\VAR{current_step_name[0]}} & \multicolumn{4}{C{\VAR{w2_7}}|}{\VAR{current_step_name[1]}} &  \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status}}} \\

% Списки для дальнейшего заполнения таблицы
%% set names_of_headers = ['Цепь №', 'Измерено (мА)', 'Допустимое значение (мА)']
%% set names = ['Ток в цепях переключения комплектов', 'Напряжение в цепях переключения комплектов (включено)', 'Напряжение в цепях переключения комплектов (выключено)']
%% set chains = ['9', '27']


% Списки с результатами
%% set results = []
%% set status_substep = []

% Вычисление результатов для цепей комплектных
%% for step in substeps:
%% set dump = results.append(e.get_numeric_limit(step))
%% set temp_status = e.get_step_status(step)
%% set dump = status_substep.append(temp_status)
%% endfor

% Вычисление результатов
%% set status_substep = h.status_of_substeps(status_substep, key = 0)

% Разбиение на 13 и 28 цепи результатов и проверок ([0] - 9, [1] - 27)
%% set results = h.power_for_kits(results, key = 1)
%% set status_substep = h.power_for_kits(status_substep, key=1)

% Шапка 'Ток в цепях переключения комплектов'
\hhline{~|--|--|--|-}
& \multirow{3}{23mm}{\VAR{names[0]}} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{names_of_headers[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{names_of_headers[1]}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{names_of_headers[2]}} & \tabularnewline

% Цепь 9
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[0][0]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[0][0]['lo']}  ÷ \VAR{results[0][0]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[0][0]}}} \tabularnewline

% Цепь 27
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[1]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[1][0]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[1][0]['lo']}  ÷ \VAR{results[1][0]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[1][0]}}} \tabularnewline

% Шапка  'Напряжение в цепях переключения комплектов (включено)'
\hhline{~|--|--|--|-}
& \multirow{5}{25mm}{\VAR{names[1]}} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{names_of_headers[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{names_of_headers[1]}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{names_of_headers[2]}} & \tabularnewline

% Цепь 9
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[0][1]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[0][1]['lo']}  ÷ \VAR{results[0][1]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[0][1]}}} \tabularnewline

% Добавление строки, для объединения 2-й колонки
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w6_7}}|}{} & \multicolumn{1}{C{\VAR{w3_6}}|}{} & \multicolumn{1}{C{\VAR{w3}}|}{} \tabularnewline


% Цепь 27
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[1]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[1][1]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[1][1]['lo']}  ÷ \VAR{results[1][1]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[1][1]}}} \tabularnewline

% Добавление строки, для объединения 2-й колонки
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w6_7}}|}{} & \multicolumn{1}{C{\VAR{w3_6}}|}{} & \multicolumn{1}{C{\VAR{w3}}|}{} \tabularnewline

% Шапка  'Напряжение в цепях переключения комплектов (выключено)'
\hhline{~|--|--|--|-}
& \multirow{5}{25mm}{\VAR{names[2]}} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{names_of_headers[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{names_of_headers[1]}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{names_of_headers[2]}} & \tabularnewline

% Цепь 9
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[0]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[0][2]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[0][2]['lo']}  ÷ \VAR{results[0][2]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[0][2]}}} \tabularnewline

% Добавление строки, для объединения 2-й колонки
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w6_7}}|}{} & \multicolumn{1}{C{\VAR{w3_6}}|}{} & \multicolumn{1}{C{\VAR{w3}}|}{} \tabularnewline

% Цепь 27
\hhline{~|~-|--|--|-}
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{\VAR{chains[1]}} & \multicolumn{1}{C{\VAR{w6_7}}|}{\VAR{results[1][2]['result']}} & \multicolumn{1}{C{\VAR{w3_6}}|}{\VAR{results[1][2]['lo']}  ÷ \VAR{results[1][2]['hi']}} & \multicolumn{1}{C{\VAR{w3}}|}{\textbf{\VAR{status_substep[1][2]}}} \tabularnewline

% Добавление строки, для объединения 2-й колонки
& \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w2_4}}|}{} & \multicolumn{1}{C{\VAR{w6_7}}|}{} & \multicolumn{1}{C{\VAR{w3_6}}|}{} & \multicolumn{1}{C{\VAR{w3}}|}{} \tabularnewline
